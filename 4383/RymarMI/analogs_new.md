## Сравнительный анализ подходов к решению проблемы  
Как было выше изложено, необходимо решить задачу деконволюции. Конволюция - операция свертки в цифровой обработке изображений. Свертка 
может быть как непрерывной, так и дискретной. В случае данной задачи исполльзуется операция дискретной свертки. Данная операция проиллюстрирована на изображении "Figure 25.2" в статье [Image Enhancement by Deconvolution]. Опираясь на данную информацию, можно операцию свертки привести к  
операции умножения матрицы на вектор, тогда задача будет переписана в следующем виде:  
y = Hx+n,  
где y \in R^N, x \in R^N, H \in R^{NxN} - матрица свертки,  полученная из ядра свертки h. Такое представление задачи изложено в [Variational Bayesian Blind Image Deconvolution, стр. 127].  
Чтобы не вычислять операцию свертки можно перейти в частотную область преобразованием фурье, так как операция свертки в такой области 
обозначает умножение. Затем будет необходимо применить обратное преобразование фурье.  
Прямое дискретное преобразование фурье:  
X_k = \sum_{n=0}^{N-1}=x_n e^{-(2 \pi i)/(N) kn} , k=0,...,N-1  
Обратное дискретное преобразование фурье:  
x_n = 1/N \sum_{n=0}^{N-1}=X_k e^{(2 \pi i)/(N) kn} n=0,...,N-1  
N-количество значений сигнала  
x_n, \quad n = 0,\dots,N-1, — измеренные значения сигнала (в дискретных временных точках с номерами {\displaystyle n=0,\dots ,N-1} n = 0,\dots,N-1), которые являются входными данными для прямого преобразования и выходными для обратного;  
{\displaystyle X_{k},\quad k=0,\dots ,N-1,} X_k, \quad k = 0,\dots,N-1, — {\displaystyle N} N комплексных амплитуд синусоидальных сигналов, слагающих исходный сигнал; являются выходными данными для прямого преобразования и входными для обратного; поскольку амплитуды комплексные, то по ним можно вычислить одновременно и амплитуду, и фазу;  
{\displaystyle |X_{k}| \over N} |X_k| \over N — обычная (вещественная) амплитуда k-го синусоидального сигнала;  
{\displaystyle \arg(X_{k})} \arg(X_k) — фаза k-го синусоидального сигнала (аргумент комплексного числа);  
{\displaystyle k} k — индекс частоты. Частота k-го сигнала равна {\displaystyle {\frac {k}{T}}} \frac{k}{T}, где {\displaystyle T} T — период времени, в течение которого брались входные данные.  
Введя необходимые обозначения для постановки задачи нужно перейти к ее решению. Далее будут рассмотрены методы нахождения четкого изображения с известным ядром размытия с применением различных регуляризаторов:  
Поиск решения задачи можно переписать в вариационном виде.  
x = argmin_x||y-Hx||_2^2,  
где ||y-Hx||_2^2=\sqrt(|x_1|^2+|x_2|^2+...+|x_N|^2)  
Термин вариационный означает, что некоторая величина, представляющая интерес, представлена как решение задачи оптимизации.  
Решение задачи можно найти аналитически, вычислив градиент и приравняв его к нулю:  
f(x) = ||y-Hx||_2^2 = (y-Hx)^T(y-HX)=y^Ty-y^THx-x^TH^Ty+x^TH^THx=y^Ty-2y^THx+x^TH^THx  
\grad(f(x)) = -2H^Ty+2H^THx = 0  
Из последнего равенства можно найти x:  
x = (H^TH)^(-1)H^Ty  
Таким образом можно найти исходное изображение. Однако целевую функцию обычно дополняют «штрафующим» членом, помогающим ограничить абсолютные значения элементов вектора x. Постановка задачи оптимизации будет переписана следующим образом:  
f(x) = argmin_x||y-Hx||_2^2 + \lambda||x||_2^2 , \lambda > 0  
Вычислив градиент и приравняв у нули можно снова найти решение даной задачи:  
\grad(f(x))=2H^T(Hx-y)+2\lambdax=0  
H^THx+\lambdax=H^Ty  
(H^TH+\lambda I)x = H^Ty , I - единичная матрица  
x = (H^TH + \lambda I)^(-1)H^Ty. Такое решение с регуляризацией представлено в [Least squares solutions to linear systems of equations].
Такой регуляризатор не избавляет фото от шума. Стоит рассмотреть регуляризацию по Соболеву: 
[https://hal.archives-ouvertes.fr/hal-00519521/document , стр.9, Sobolev prior]
g(x) = argmin_x||y-Hx||_2^2 + \lambdaJ(x)_2^2 , \lambda > 0
J(x) = \sum||\gradf(x)||^2, где \grad(f(x) - дискретный градиент, то есть конечные разности соседних пикселей
Взяв градиент от g(x), можно получить решение:
H^THx + \lambda \sum grad(x) = H^Ty
x = (H^TH)^(-1)(H^Ty-\lambda\sum grad(x))
Таким образом регуляризация по Соболеву должна штрафовать высокие частоты, благодаря использованию градиента.
Такая регуляризация выполняет шумоподавления, однако может размывать края изображению. Существует реуляризация, которая может помочь с 
данной проблемой : регуляризация TV (Total variation). Представлена в [https://miplab.epfl.ch/pub/karahanoglu1101p.pdf стр. 2  ]:
Дискретная версия:
TV(x) = \sum_n|D(x)|, где D(x) = x_t_n-x_t_(n-1) - дискретная производная.
Такой регуляризатор является l_1-нормой, в отличие от регляризации Соболева. Главные эффекты TV - сглаживание однородных областей при сохранении ребер. Напротив, l_2 нормы, как например, Соболева норма стремятся к сглаживанию ребер.
Задачу можно переисать в следующем виде:
g(x) = argmin_x||y-Hx||_2^2 + \lambda\sum_n|D(x)|, \lambda > 0
Решение задачи будет в виде: x = (H^TH)^(-1)(H^Ty-\lambda \\lambda \sum |D(x)|)
Такой функционал TV не является гладкой функцией. Можно заменить абсолютное значение на гладкое абсолютное значени. Сглаженная TV-норма:
J(x) = \sum \sqrt(||grad(f(x))||^2+\epsilon^2)
epsilon- параметр регуляризации. Когда параметр близок к 0, то выражение становится близким к стандартному TV. Но когда |\epsilon| становится большим - значение выражение становится близким к значению Соболева, описанной выше.
Такая априорная информация не является квадратичной, поэтому не может быть выражено в форме Фурье. Следоватльно, такой алгоритм является итерационным, шаг итерации можно представить так [https://hal.inria.fr/inria-00070726/document на стр. 21, формула 23] :
x^(k+1) = x^(k) - \tau(h*(h*x^(k)-y)+\lambda grad J(x^(k)))
Такой способ имеет название в "методах оптимизации" как градиентный спуск. \tau - шаг спуска,
grad(J(x)) = -div(grad(x)/(\sqrt(||grad(f)||^2 + \epsilon^2)))
Из вышеизложенного следует, что есть несколько способов решения проблемы. Для задачи необходимо выбрать ядро рызмытия, которое предполагается известным априори. Одно из решений - представить ядро гауссовским. Способы построения Гауссова ядра размытия описаны в [https://homepages.inf.ed.ac.uk/rbf/HIPR2/gsmooth.htm]. Такое ядро подчиняется двумерному гауссовскому распределению:
p(x,y) = 1/(2*\pi*\sigma^2)\exp(-(x^2+y^2)/(2 \sigma^2))
Предположения о характере ядра свертки сделано, но необходимо также определить размер этого ядра. Его можно задать также произвольно,  но есть и способ вычисления, который описан в [https://blog.demofox.org/2015/08/19/gaussian-blur/]. Эта формула:
1+2\sqrt(-2 \sigma^2ln0.005)
Краткое сравнение предложенных методов решения:
(таблица)
То есть необходимо задать также случайный параметр \sigma. Но стоит отметить, что смаз фотографии далеко невсегда может быть гауссовым, поэтому матрицу H можно выбирать и абсолютно случайную, не основываясь на ее априорном Гауссовом распределении.
Подводя итоги вышеизложенного можно увтерждать, что задача восстановления не является корректно поставленной,  так как в ней неизвестных параметров больше известных. Способо,  учитывающий наличие ядра свертки, упрощает задачу, так как решение ее находится аналитически. Однако и в этом случае, необходимо вводить регулризацию, чтобы изображение получалось "красивым" для сфотографировашего. Выбор правильного ядра свертки - также довольно непростая задача, так как природа его происохждения может быть совершенно разной. Для решения задачи деконволюции написанным в этой статье способой необходимо проводить различные тесты на разных изображениях, так как выбор ядра свертки, а также правильной функции с регуляризатором будет зависеть от конкретного случая. 
